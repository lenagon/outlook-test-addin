<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script>
    Office.onReady(() => {
      // ВАЖНО для ExecuteFunction:
      Office.actions.associate("test1", test1);
      Office.actions.associate("test2", test2);
    });

    function test1(event) {

    fetch("https://localhost:7212/api/test")
        .then(response => response.text())
        .then(data => {
            Office.context.mailbox.item.notificationMessages.replaceAsync("t1", {
                type: "informationalMessage",
                message: data,
                persistent: false
            });
        })
        .catch(error => {
            Office.context.mailbox.item.notificationMessages.replaceAsync("t1", {
                type: "informationalMessage",
                message: "Error calling backend",
                persistent: false
            });
            console.error(error);
        });

    event.completed();
}

    function test2(event) {
      Office.context.mailbox.item.notificationMessages.replaceAsync("t2", {
        type: "informationalMessage",
        message: "test2",
        persistent: false
      });
      event.completed();
    }
  </script>
</head>
<body></body>
</html>
